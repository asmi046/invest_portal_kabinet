В файле миграций database\migrations\2025_08_04_141648_create_declarations_table.php обяви поля таблицы руководствуясь списком:

- id заявителя (связь один к одному с моделью User)
- id организации (целое число)
- Тип документа (полиморфная связь с моделями типов документов)

Обязательно проставь ->comment
Так же на основе этой миграции заполни поле $fillable и $casts соответствующей модели

______


В файле миграций database\migrations\2025_08_04_142655_create_organizations_table.php обяви поля таблицы руководствуясь списком:

- Название организации (строка)
- Сокращенное название организации (строка)
- Телефон (строка, nullable)
- e-mail (строка, nullable)
- Документы доступные для обработки (полиморфная связь один ко многим с моделями типов документов)


Обязательно проставь ->comment
Так же на основе этой миграции заполни поле $fillable и $casts соответствующей модели

______

В сидере DocumentTypeSeeder.php сделай заполнение таблицы document_types на основе толей из миграции 2025_08_05_104635_create_document_types_table.php

В таблицу должны быть добавленны следующие элементы:

App\Models\AreaGet - Заявление на выделение земельного участка
App\Models\Project - Заявление на финансирование инвестиционного проекта
App\Models\TechnicalConnects - Заявление на технологическое присоединение к электрическим сетям
App\Models\Support - Заявление на государственную поддержку

Действуй на уровне базы данных а не моделей элоквент.

______

Реализуй следующую логику: в коллекции $user->documentTypes у каждого элемента есть поле model, если в коллекции есть элемент с полем model = 'App\Models\AreaGe' то возвращаем true иначе false

______

В файле миграций database\migrations\2025_08_05_173127_create_stages_table.php обяви поля таблицы руководствуясь списком:

- Имя (строка)
- Порядок (целое число по умолчанию 0)
- Описание (текст, nullable)
- Внешний ключ к таблице document_types


Обязательно проставь ->comment
Так же на основе этой миграции заполни поле $fillable и $casts соответствующей модели

_______


в файле app\Services\SmevEnvvelopeService.php перепиши метод setContractsData чтобы он реализовывал следующий алгоритм:

В переменную $files предается массив следующего вида:

[
           [
                'Document' => [
                    'uuid' => '28a2624e-c59e-4d82-89c9-4db9d451bb7f',
                    'docId' => '7b3ad8aa-026b-40df-83f2-0b7969083456',
                    'mimeType' => 'application/pdf',
                    'description' => 'Договор'
                ],

                'Signature' => [
                    [
                        'docId' => '7b3ad8aa-026b-40df-83f2-0b7969083456',
                        'uuid' => '70f5753a-1747-4542-a673-e892d1204836',
                        'mimeType' => 'application/x-pkcs7-signature',
                        'description' => 'Подпись'
                    ]
                ]
            ],

            [
                'Document' => [
                    'docId' => '7b3ad81a-026b-40df-83f2-0b7969083456',
                    'uuid' => \Ramsey\Uuid\Uuid::uuid1()->toString(),
                    'mimeType' => 'application/pdf',
                    'description' => 'Договор'
                ],

                'Signature' => [
                    [
                        'docId' => '7b3ad81a-026b-40df-83f2-0b7969083456',
                        'uuid' => \Ramsey\Uuid\Uuid::uuid1()->toString(),
                        'mimeType' => 'application/x-pkcs7-signature',
                        'description' => 'Подпись'
                    ]
                ]
            ],


        ]

Нужно в переданном документе найти секцию Contracts и заполнить ее элементами чтобы на выходе получилась вот такая структура:

<Contract>
			<Document docId="7b3ad8aa-026b-40df-83f2-0b7969083456" uuid="28a2624e-c59e-4d82-89c9-4db9d451bb7f" mimeType="application/pdf" description="Договор"/>
			<Signature docId="7b3ad8aa-026b-40df-83f2-0b7969083456" uuid="70f5753a-1747-4542-a673-e892d1204836" mimeType="application/x-pkcs7-signature" description="Подпись"/>

            <Document docId="..." uuid="..." mimeType="application/pdf" description="Договор"/>
			<Signature docId="..." uuid="..." mimeType="application/x-pkcs7-signature" description="Подпись"/>
</Contract>


______

В файле миграций  database\migrations\2025_08_07_112217_create_goskey_registries_table.php обяви поля таблицы руководствуясь списком:

- ID сообщения (uuid)
- Короткий идентификатор (строка, 70 символов)
- ID пользователя
- Тип документа
- Дата и время последней проверки
- Статус (строка, nullable)

Обязательно проставь ->comment
Так же на основе этой миграции заполни поле $fillable и $casts соответствующей модели
_____________

В текущем файле в методе signXmlFileViaNetwork считай данные из файла $xmlFilePath и при помощи встроенного http клиента отправь данные по адресу из конфига cryptcp_xml_address методом post с использованием multipart/form-data имя параметрк должно быть file. Так же должны быть переданы следующие параметры:
elementId со значением SIGNED_BY_CALLER
signatureElementName со значением ns:CallerInformationSystemSignature

В случае успеха результат должен быть записан в файл $outputFilePath
В случае если запрос будет с ошибкой то выброси исключение

_____________


Мне нужно написать метод в который будет передаваться simplxml и массив с параметрами
метод находит в документе узел <ns1:RefAttachmentHeaderList> и вставляет в него элементы:

<ns1:RefAttachmentHeader>
    <ns1:uuid>?</ns1:uuid>
    <ns1:Hash>?</ns1:Hash>
    <ns1:MimeType>?</ns1:MimeType>
</ns1:RefAttachmentHeader>

сгенерированные на основе массива

_____________

В текущем файле сервиса в методе analyze реализуй следующий функционал:
В него передается результат в виде xml
Метод производит проверку на наличие узла <soap:Fault> если этот узел присутствует то он находит внутри этого узла сдедующие параметры:
    -Узел faultstring его значение записываем в массив под одноименным ключем
    -Узел Code его значение записываем в массив под одноименным ключем
Иначе находит элемент ns2:MessageMetadata внутри которого находим элемент <ns2:Status> и его значение записываем под одноименным ключем в массив

Метод возвращает заполненный массив

_______

В комопненте resources\js\components\GoskeySignPanel.vue реализуй следующий функционал:

Сделай так чтобы в этот компонент передавались следующие пропсы:
    - модель документа (строка)
    - id документа (целое число)

Для кнопок с классами fign_fl, fign_ul сделай обработчики которые будут отправлять Get запрос на следующие адреса:
/goskey/sign_fl и /goskey/sign_ul соответственно. При отправке запросов в качестве параметров должны передаваться пропсы компонента
_____________

Сделай сервис назови его PrintServices в метод save которого будет переданы следующие параметры:
- класс модели
- id модели
- путь к файлу

Метод будет разрешать модель по переданной строке класса модели и вызывать выбирать нужный экзкмпляр модели по id и вызывать у этой модели метод принт предварительно проверив его наличие
